# Speech-to-Visuals システム憲法 V1.0

## 🎯 **明確な技術的境界線**

### **原則: シンプルであることの厳密な定義**

**Speech-to-Visuals = 音声ファイルから自動的に図解とアニメーション動画を生成する単一目的の自動化システム**

これ以外の機能は一切認めない。

### **厳格な禁止リスト（絶対）**

#### 🔒 **完全禁止カテゴリー**
- [ ] **動画編集機能** - カット編集、エフェクト追加、BGM挿入、字幕編集
- [ ] **高度なアニメーション** - 3Dアニメーション、複雑なモーション、インタラクティブ要素
- [ ] **マルチメディア処理** - 画像認識、顔検出、物体検出、高度なCV処理
- [ ] **AI対話システム** - チャットボット、質疑応答、対話的インターフェース
- [ ] **コンテンツ管理** - 動画ライブラリ、プレイリスト、ユーザー生成コンテンツ
- [ ] **配信・共有機能** - SNS連携、ライブ配信、コメントシステム
- [ ] **ユーザー管理** - アカウント作成、プロフィール、権限管理
- [ ] **高度なカスタマイズ** - テーマエディタ、レイアウト設計、ブランド設定
- [ ] **分析・レポート** - 視聴データ、利用状況、パフォーマンス分析
- [ ] **多言語対応** - 翻訳機能、多言語UI、字幕翻訳

### **許可される機能（ホワイトリスト方式）**

#### ✅ **コア機能（明確に定義）**

```python
# 許可される処理の例：
class SpeechToVisualsGenerator:
    """
    音声→図解動画自動生成機能
    入力: 音声ファイル (.wav, .mp3, .m4a)
    出力: 図解アニメーション動画 (.mp4, 1080p 30fps)
    """
    async def generate_video(self, audio_file: str) -> str:
        # ✅ 許可される処理：
        # - Whisper + Web Speech API による文字起こし (90-95%精度)
        # - AIによる内容分析と図解タイプ自動検出 (85%精度)
        # - ゼロオーバーラップレイアウトエンジンによる図解配置
        # - Remotion によるアニメーション動画出力 (1080p 30fps)
        # - 自動的な図解とテキストのタイミング同期

        # ❌ 禁止される処理：
        # - 手動編集機能
        # - 高度な動画エフェクト
        # - インタラクティブ要素
        # - ユーザーカスタマイズ
        pass

    def detect_diagram_types(self, transcript: str) -> List[str]:
        # ✅ 許可される処理：
        # - フローチャート検出
        # - 階層構造図検出
        # - 比較図検出
        # - プロセス図検出

        # ❌ 禁止される処理：
        # - 複雑な図解タイプ
        # - ユーザー定義の図解
        # - 動的な図解生成
        pass
```

#### ✅ **許可される依存関係**
```json
{
  "dependencies": {
    // 音声認識（必須）
    "openai-whisper": "^1.0.0",
    "speech-recognition": "^3.10.0",

    // AI分析（最低限）
    "openai": "^4.0.0",

    // 動画生成（必須）
    "remotion": "^4.0.0",
    "@remotion/cli": "^4.0.0",

    // 図解生成（最小限）
    "mermaid": "^10.0.0",
    "d3": "^7.0.0",

    // 音声処理
    "node-ffmpeg": "^0.6.0",

    // 基本的なWebフレームワーク
    "express": "^4.18.0",
    "multer": "^1.4.0"
  },
  "devDependencies": {
    "typescript": "^5.0.0",
    "@types/node": "^20.0.0",
    "nodemon": "^3.0.0"
  }
}

// 明確に禁止する依存関係：
// - 動画編集ライブラリ (ffmpeg-pro, video.js)
// - 高度なCVライブラリ (opencv.js, tensorflow.js)
// - 認証・管理ライブラリ (passport, jwt)
// - データベースライブラリ (mongodb, prisma)
// - 分析・監視ライブラリ (google-analytics, mixpanel)
```

### **実装制約（絶対遵守）**

#### 📁 **ディレクトリ構造の制約**
```
src/
├── speech/
│   ├── transcriber.ts           # ✅ 音声認識
│   └── processor.ts             # ✅ 音声前処理
├── analysis/
│   ├── content-analyzer.ts      # ✅ 内容分析
│   └── diagram-detector.ts      # ✅ 図解タイプ検出
├── visualization/
│   ├── layout-engine.ts         # ✅ ゼロオーバーラップ配置
│   └── diagram-generator.ts     # ✅ 図解生成
├── video/
│   ├── animation-engine.ts      # ✅ Remationアニメーション
│   └── renderer.ts              # ✅ 動画レンダリング
└── api/
    ├── upload-endpoint.ts       # ✅ ファイルアップロード
    └── generation-endpoint.ts   # ✅ 生成API
```

**禁止**:
- `editing/`, `effects/`, `filters/` ディレクトリ
- `interactive/`, `dynamic/`, `real-time/` ディレクトリ
- `users/`, `auth/`, `profiles/` ディレクトリ
- `social/`, `sharing/`, `comments/` ディレクトリ
- `analytics/`, `monitoring/`, `reports/` ディレクトリ

#### 🔄 **処理フローの制約**
```python
# 許可される単純な処理フロー：
1. ユーザーが音声ファイルをアップロード
2. Whisper + Web Speech APIで文字起こし実行
3. AIが内容を分析し図解タイプを自動検出
4. ゼロオーバーラップレイアウトで図解を配置
5. Remotionでアニメーション動画を生成
6. 1080p 30fpsのMP4ファイルを出力

# 禁止される処理：
- 手動編集やカスタマイズ機能
- ユーザーとの対話的処理
- 高度な動画エフェクトやトランジション
- 複数のメディアを組み合わせる処理
- SNS連携や共有機能
```

#### 📏 **コード規模の制約**
```
制限:
- 総ファイル数: 25ファイル以下
- 総コード行数: 2,000行以下
- 1ファイルあたり: 150行以下
- 1関数あたり: 40行以下
- 1クラスあたり: 120行以下
```

### **厳格なレビュープロセス**

#### ✅ **全機能追加は以下のチェックに通過必須**

1. **単一目的テスト**: この機能は音声→図解動画生成にのみ使用されるか？
2. **自動化テスト**: この機能は完全自動化か？手動編集を必要としないか？
3. **シンプル性テスト**: この機能は単純な入出力変換か？
4. **独立性テスト**: 他のシステムと複雑に連携しないか？
5. **品質テスト**: 生成品質（90-95%認識精度、85%図解検出精度）を維持するか？

#### ❌ **自動リジェクト条件**
- `editing/`, `effects/`, `manual/` などの手動編集名前
- `interactive/`, `dynamic/`, `real-time/` などの対話機能名前
- `users/`, `auth/`, `social/` などの管理機能名前
- `analytics/`, `monitoring/`, `reports/` などの分析機能名前
- 1ファイルが150行を超える実装
- 手動編集やカスタマイズ機能
- 高度な動画エフェクト処理
- ユーザー管理や認証機能

### **監視と強制**

#### 🔍 **自動違反検出**
```bash
# CI/CDで実行する憲法違反チェック：
find src/ -name "*.ts" | xargs wc -l | awk '$1 > 150 && $2 != "total"' && exit 1  # ファイルサイズ制限
find src/ -name "*editing*" -o -name "*manual*" -o -name "*interactive*" && exit 1  # 手動編集禁止
find src/ -name "*user*" -o -name "*auth*" -o -name "*social*" && exit 1  # 管理機能禁止
find src/ -name "*analytics*" -o -name "*monitoring*" -o -name "*reports*" && exit 1  # 分析機能禁止
grep -r "ffmpeg-pro\|video.js\|opencv" src/ && exit 1  # 高度なメディア処理禁止
grep -r "passport\|jwt\|mongodb" src/ && exit 1  # 認証・DB禁止
```

#### 📊 **メトリクス監視**
- **ファイル数**: 25ファイルを超えたら警告
- **コード行数**: 2,000行を超えたら警告
- **依存関係**: 15ライブラリを超えたら警告
- **生成時間**: 動画生成が5分を超えたら警告

### **歴史的経緯と教訓**

#### ⚠️ **肥大化の予防**
多くの動画生成ツールが以下の機能追加により複雑化した：
1. **動画編集機能**: カット編集、エフェクト、BGM、字幕
2. **インタラクティブ要素**: クリック可能、動的コンテンツ
3. **ユーザー管理**: アカウント、プロフィール、権限
4. **SNS連携**: 共有、コメント、ライク機能
5. **高度なカスタマイズ**: テーマ、レイアウト、ブランド設定
6. **分析機能**: 視聴データ、利用状況分析

#### 🎯 **本来の目的に固執**
音声からの自動図解動画生成という本来の目的に徹し、完全自動化された変換機能に集中する。

## 違反時の対応

### 🚨 **違反検出時の即時対応**
1. 該当コードの即時削除
2. 憲法違反レポートの提出
3. 再発防止策の策定

### ⚡ **即時修正**
違反は記録せず、即時修正する。肥大化を招く記録は禁止。

---

**この憲法は、Speech-to-Visualsが永遠にシンプルで単一目的な音声→図解動画変換ツールであり続けることを保証する。**

*制定日: 2025-12-13*
*改正: V1.0 - 完全自動化に特化し、手動編集機能を排除*